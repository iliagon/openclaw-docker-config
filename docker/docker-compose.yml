services:
  openclaw-gateway:
    image: ghcr.io/${GHCR_USERNAME}/openclaw-docker-config/openclaw-gateway:latest
    env_file: .env
    restart: unless-stopped
    environment:
      HOME: /home/node
      NODE_ENV: production
      TERM: xterm-256color
      ANTHROPIC_API_KEY: ${ANTHROPIC_API_KEY}
      OPENCLAW_GATEWAY_TOKEN: ${OPENCLAW_GATEWAY_TOKEN}
      OPENCLAW_GATEWAY_PORT: ${OPENCLAW_GATEWAY_PORT:-18789}
      OPENCLAW_GATEWAY_BIND: ${OPENCLAW_GATEWAY_BIND:-0.0.0.0}
      TELEGRAM_BOT_TOKEN: ${TELEGRAM_BOT_TOKEN}
      BRAVE_API_KEY: ${BRAVE_API_KEY}
    volumes:
      - ${OPENCLAW_CONFIG_DIR:-/home/openclaw/.openclaw}:/home/node/.openclaw
      - ${OPENCLAW_WORKSPACE_DIR:-/home/openclaw/.openclaw/workspace}:/home/node/.openclaw/workspace
    ports:
      - "127.0.0.1:${OPENCLAW_GATEWAY_PORT:-18789}:18789"
    command: openclaw gateway --bind lan --port 18789

  workspace-sync:
    image: ghcr.io/${GHCR_USERNAME}/openclaw-docker-config/workspace-sync:latest
    restart: unless-stopped
    environment:
      GIT_WORKSPACE_REPO: ${GIT_WORKSPACE_REPO:-}
      GIT_WORKSPACE_BRANCH: ${GIT_WORKSPACE_BRANCH:-auto}
      GIT_WORKSPACE_TOKEN: ${GIT_WORKSPACE_TOKEN:-}
      GIT_WORKSPACE_SYNC_SCHEDULE: ${GIT_WORKSPACE_SYNC_SCHEDULE:-0 4 * * *}
    volumes:
      - ${OPENCLAW_WORKSPACE_DIR:-/home/openclaw/.openclaw/workspace}:/workspace
    profiles:
      - sync
